$bl-form-border: map-get($ecl-colors, 'grey-25') !default;
$bl-form-border-strong: map-get($ecl-colors, 'grey-50') !default;
$bl-form-background: map-get($ecl-colors, 'grey-5') !default;
$bl-form-background-dragged: map-get($ecl-colors, 'yellow-25') !default;
$bl-form-background-hover: map-get($ecl-colors, 'grey-10') !default;
$bl-form-background-header: map-get($ecl-colors, 'grey-15') !default;
$bl-fieldset-margin-v: map-get($ecl-spacing, 's');
$bl-fieldset-padding: map-get($ecl-spacing, 'm');
$bl-fieldset-padding-t: map-get($ecl-spacing, 'xl');

/* stylelint-disable  selector-max-compound-selectors */
/* stylelint-disable selector-no-qualifying-type */
/* stylelint-disable max-nesting-depth */
/* stylelint-disable no-descending-specificity */

/* edit forms */
.ecl-form {
  /* action buttons */
  .ecl-button {
    margin-right: map-get($ecl-spacing, 'xs');
    margin-top: map-get($ecl-spacing, 'xxs');
  }
  .ecl-button:first-child {
    margin-left: 0;
  }
  .ecl-button:last-child {
    margin-right: 0;
  }

  /* checkbox in the permissions table */
  .permissions .ecl-form-label.ecl-checkbox {
    text-align: center;
  }

  /* show description and show/hide button link */
  %button.link {
    background: transparent;
    border: 0;
    color: $ecl-color-primary;
    cursor: pointer;
    font-size: 0.89em;
    line-height: 2;
    margin: 0;
    padding: 0;
    text-decoration: none;
  }
  button.link {
    @extend %button.link;
  }
  button.link:hover {
    text-decoration: underline;
  }
  .compact-link a {
    @extend %button.link;

    &:hover {
      text-decoration: underline;
    }
  }

  /* inner fieldset */
  summary ~ div {
    padding: 0 $bl-fieldset-padding $bl-fieldset-padding;
  }

  /* chosen select replacment */
  .chosen-container {
    padding-left: 0;
    padding-right: 0;
  }
  .chosen-single {
    background: none;
    border: 0;
    box-shadow: none;
  }
  .chosen-single span ~ div {
    display: none;
  }

  /* weight select for ordering */
  .delta-order select {
    float: right;
    width: auto;
  }

  /* text format after text area */
  .js-form-type-textarea ~ .ecl-form-group {
    margin-top: 0;
  }

  /* Draggable area for paragraphs */
  .draggable .ecl-table__group-label {
    vertical-align: top;
  }
  .draggable .paragraphs-subform.ecl-form-group{
    margin-top: map-get($ecl-spacing, 'xxs');
  }

  /* fieldsets */
  fieldset:not(.fieldgroup) {
    background-color: $bl-form-background;
    border: 1px solid $bl-form-border;
    border-radius: 0;
    margin: $bl-fieldset-margin-v 0;
    min-width: 0;
    padding: $bl-fieldset-padding-t $bl-fieldset-padding  $bl-fieldset-padding;
    position: relative;
  }
  fieldset:not(.fieldgroup) > legend {
    font-size: 1em;
    font-weight: bold;
    letter-spacing: 0.08em;
    position: absolute;
    text-transform: uppercase;
    top: 10px;
  }
  fieldset details {
    background-color: $bl-form-background;
    border: 1px solid $bl-form-border;
    border-radius: 0;
    margin-bottom: $bl-fieldset-margin-v;
    margin-top: $bl-fieldset-margin-v;
    summary {
      color: $ecl-color-primary;
      cursor: pointer;
      font-weight: bold;
      padding: $bl-fieldset-padding  $bl-fieldset-padding;
      text-transform: uppercase;
    }
  }

  /* image widget */

  .image-widget {
    margin-top: $bl-fieldset-margin-v;
  }

  .image-widget .image-preview {
    float: left;
    margin-right: $bl-fieldset-margin-v;
  }

  .image-widget .image-widget-data {
    float: left;
  }

  * + .ecl-help-block {
    margin-top: 0.4rem;
  }

  // help text

  .description {
    @extend .ecl-help-block;
  }

  // form actions

  .form-actions {
    margin: map-get($ecl-spacing, 'xs') 0 map-get($ecl-spacing, 'l') 0;
  }

}

/* autocomplete indicator */
.js input.form-autocomplete {
  background-position-x: 99%;
}

/* vertical tabs */
.vertical-tabs,
.vertical-tabs__menu,
.vertical-tabs .vertical-tabs__panes {
  font-size: 1em;
}
.vertical-tabs .vertical-tabs__panes .ecl-checkbox {
  font-size: 1em;
}
.vertical-tabs .vertical-tabs__menu-item {
  background-color: $bl-form-background;
}
.vertical-tabs .vertical-tabs__menu-item-summary,
.vertical-tabs .vertical-tabs__panes .ecl-help-block.description {
  font-size: 0.89em;
  line-height: 1.2;
}
.vertical-tabs .vertical-tabs__panes {
  padding: map-get($ecl-spacing, 'xs');

  .ecl-help-block {
    margin-top: map-get($ecl-spacing, 'xxxs');
  }
}
.vertical-tabs__menu-item a {
  padding: map-get($ecl-spacing, 'xs');
}

/* local actions */
.block-local-actions-block {

  .ecl-button {
    margin-right: map-get($ecl-spacing, 'xs');
    margin-top: map-get($ecl-spacing, 'xxs');
  }

  span:first-child .ecl-button {
    margin-left: 0;
  }

  span:last-child .ecl-button{
    margin-right: 0;
  }
}

/* tables */
.ecl-table tr {
  border-bottom: 1px solid $bl-form-border;
}
.ecl-table tr.drag-previous {
  background-color: $bl-form-background-dragged;
}
.ecl-table tr:hover {
  background-color: $bl-form-background-hover;
}
tr:hover .ecl-checkbox__label::before {
  background-color: $bl-form-background-hover;
}
.ecl-table tr:nth-of-type(2n):not(:hover):not(.drag-previous) {
  background-color: unset;
}
.ecl-table th {
  background-color: $bl-form-background-header;
  border: solid 1px $bl-form-border-strong;
  border-width: 1px 0;
}
th h4 {
  margin: 0;
}
td > a,
th > a {
  text-decoration: none;
}
td > a:hover,
th > a:hover {
  text-decoration: underline;
}
td ul > li {
  font-size: 1rem;
}
table.sticky-header {
  border-spacing: 0;
}
table.sticky-header th{
  background-color: $bl-form-background-header;
  border: solid 1px $bl-form-border-strong;
  border-width: 1px 0;
  padding: 0.89rem;
  text-align: left;
}
.ecl-table thead tr:first-child th {
  border-bottom: solid 1px $bl-form-border-strong;
}
td .description {
  font-size: 0.89em;
  line-height: 1.4;
  margin-top: map-get($ecl-spacing, 'xxxs');
}

/* button group */
.js td .dropbutton-multiple .dropbutton-action a,
.js td .dropbutton-multiple .dropbutton-action input,
.js td .dropbutton-multiple .dropbutton-action button {
  text-decoration: none;
  text-decoration-color: transparent;
}
.js td .dropbutton-multiple .dropbutton-action a:hover {
  text-decoration: underline;
}
.js .dropbutton-single .dropbutton-widget,
.js .dropbutton-multiple .dropbutton-widget {
  @extend .ecl-button;
  @extend .ecl-button--primary;

  margin: 0;
  padding: 0 2em 0 0;
  a {
    color: #fff;
    padding: 4px 1.5em;
    //text-decoration: none;
  }
}
.js .dropbutton-single .dropbutton-widget {
  padding: 0;
  position: relative;
}
.dropbutton-multiple.open .dropbutton-widget{
  @extend .ecl-button--default:hover;
  @extend .ecl-button:focus;

  a {
    //text-decoration: none;
    //text-decoration-color: transparent;
  }
}
.ecl-button--primary:hover,
.js .dropbutton-multiple .dropbutton-widget:hover,
.ecl-button--primary:focus,
.js .dropbutton-multiple .dropbutton-widget:focus,
.ecl-button--primary:active,
.js .dropbutton-multiple .dropbutton-widget:active {
  background: #fff;

  input, a, button {
    color: $ecl-color-primary;
  }
  input:hover, button:hover {
    cursor: pointer;
    text-decoration: underline;
  }
}
.dropbutton-toggle button {
  color: #fff;
}
.dropbutton-widget:hover .dropbutton-toggle button {
  color: $ecl-color-primary;
}
.js .dropbutton-widget .button,
.js .dropbutton-widget button {
  background: transparent;
  border: 0;
  border-radius: 0;
  box-shadow: none;
}
.js .dropbutton .dropbutton-action > input,
.js .dropbutton .dropbutton-action > a,
.js .dropbutton .dropbutton-action > button {
  color: #fff;
  -webkit-font-smoothing: antialiased;
  font-weight: 600;
  line-height: 1.66;
  margin: 0;
  padding: 0;
  padding: 4px 1.5em;
  text-align: left;
  text-decoration: none;
}
//.js .dropbutton-widget .dropbutton-action a,
//.js .dropbutton-widget .dropbutton-action input,
//.js .dropbutton-widget .dropbutton-action button {
//
//}
// Dropdown in paragraphs
.form-wrapper .paragraphs-actions {
  .button, button, input {
    margin-bottom: 0;
    margin-top: 0;
  }
}
.form-wrapper .paragraphs-dropdown-actions  {
  .button, button, input {
    border: 0;
    margin-top: 0;
    text-align: left;
    width: 100%;
  }
  .button:hover, button:hover, input:hover {
    cursor: pointer;
  }
}


// SPECEFIC EDIT FORMS

// group post management
// TODO: Test and Remove the .group-post-management class
.group-post-management,
.views-exposed-form {
  background: #f7f7f7;
  border: 1px solid #333;
  box-sizing: border-box;
  display: grid;
  grid-column-gap: map-get($ecl-spacing, 'm');
  grid-row-gap: map-get($ecl-spacing, 'm');
  grid-template-areas: 
    'publish-status collection'
    'form-submit form-submit';
  margin-bottom: map-get($ecl-spacing, 'm');
  padding: map-get($ecl-spacing, 'm');
  width: 100%;
  .ecl-form-group {
    // TODO: Test and remove this commented out code.
    // We do not need(?) this rule. We just let them flow.
    // grid-area: publish-status;
  }
  .ecl-fieldset.form-wrapper {
    border: initial;
    grid-area: collection;
    margin: 0;
    padding: 0;
    .ecl-form-legend {
      letter-spacing: initial;
      line-height: initial;
      margin: 0;
      position: relative;
      text-transform: initial;
      top: 0;
    }
    .fieldset-wrapper {
      margin-top: map-get($ecl-spacing, 'xs'); 
    }
  }
  .form-actions {
    // TODO: Test and remove this commented out code.
    // We always force the action to start in a new row.
    // grid-area: form-submit;
    grid-column-start: 1;
    margin: 0;
  }

  &> .ecl-form-group,
  &> * + .ecl-form-group {
    margin: 0;
  }
}
// put a background on the active navigation list link.
.ecl-navigation-list--small .ecl-link.ecl-navigation-list__link--active {
  background: $ecl-color-secondary;
}

// fix margin for group radio form items
.ecl-form-group.js-form-type-radio:first-child {
  margin-top: map-get($ecl-spacing, 'xs'); 
}

* + .ecl-form-group.js-form-type-radio {
  margin-top: 0; 
}
